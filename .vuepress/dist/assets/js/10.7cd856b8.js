(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{281:function(a,s,t){"use strict";t.r(s);var e=t(14),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"指令笔记"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指令笔记"}},[a._v("#")]),a._v(" 指令笔记")]),a._v(" "),s("h2",{attrs:{id:"vits-fast-fine-tuning"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vits-fast-fine-tuning"}},[a._v("#")]),a._v(" VITS-fast-fine-tuning *")]),a._v(" "),s("blockquote",[s("p",[a._v("文字   》》》 声音")])]),a._v(" "),s("p",[a._v("链接地址："),s("a",{attrs:{href:"https://github.com/Plachtaa/VITS-fast-fine-tuning",target:"_blank",rel:"noopener noreferrer"}},[a._v("VITS-fast-fine-tuning"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("作者："),s("a",{attrs:{href:"https://github.com/Plachtaa",target:"_blank",rel:"noopener noreferrer"}},[a._v("Plachtaa"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"主要流程-colab版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主要流程-colab版"}},[a._v("#")]),a._v(" 主要流程（Colab版）")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# STEP 1 复制代码库")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://github.com/Plachtaa/VITS-fast-fine-tuning.git\npip "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("imageio")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.4")]),a._v(".1\npip "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--upgrade")]),a._v(" youtube-dl\npip "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" moviepy\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" VITS-fast-fine-tuning\npip "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" requirements.txt\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# build monotonic align")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" monotonic_align/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" monotonic_align\npython setup.py build_ext "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--inplace")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" pretrained_models\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# download data for fine-tuning")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://huggingface.co/datasets/Plachta/sampled_audio4ft/resolve/main/sampled_audio4ft_v2.zip\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("unzip")]),a._v(" sampled_audio4ft_v2.zip\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# create necessary directories")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" video_data\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" raw_audio\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" denoised_audio\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" custom_character_voice\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" segmented_character_voice\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# STEP 1.5 选择预训练模型")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 直接用 CJ 模型（中日）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://huggingface.co/spaces/sayashi/vits-uma-genshin-honkai/resolve/main/model/D_0-p.pth "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./pretrained_models/D_0.pth\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://huggingface.co/spaces/sayashi/vits-uma-genshin-honkai/resolve/main/model/G_0-p.pth "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./pretrained_models/G_0.pth\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://huggingface.co/spaces/sayashi/vits-uma-genshin-honkai/resolve/main/model/config.json "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./configs/finetune_speaker.json\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# STEP 2 上传您的角色音频数据 ")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 这里用github上的天降游戏短音频，并解压")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/Ikaros-521/VITS-fast-fine-tuning/releases/download/v1.0/default.zip "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./custom_character_voice/custom_character_voice.zip\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("unzip")]),a._v(" ./custom_character_voice/custom_character_voice.zip "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" ./custom_character_voice/\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# STEP 3 自动处理所有上传的数据")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将所有视频（无论是上传的还是下载的，且必须是.mp4格式）抽取音频（无）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# run video2audio.py")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将所有音频（无论是上传的还是从视频抽取的，必须是.wav格式）去噪")]),a._v("\npython denoise_audio.py\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 分割并标注长音频（无）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# python long_audio_transcribe.py --languages "{PRETRAINED_MODEL}" --whisper_size large')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 标注短音频")]),a._v("\npython short_audio_transcribe.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--languages")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"{PRETRAINED_MODEL}"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--whisper_size")]),a._v(" large\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# STEP 3.5 训练前昔")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 以下情况请勾选：")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 总样本少于100条/样本包含角色只有1人/样本质量一般或较差/样本来自爬取的视频")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# run preprocess_v2.py --languages "{PRETRAINED_MODEL}"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#以下情况可以不勾选：")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#总样本量很大/样本质量很高/希望加速训练/只有二次元角色")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 选上吧")]),a._v("\nrun preprocess_v2.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--add_auxiliary_data")]),a._v(" True "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--languages")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"{PRETRAINED_MODEL}"')]),a._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# STEP 4 开始训练")]),a._v("\n\nreload_ext tensorboard\ntensorboard "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--logdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"./OUTPUT_MODEL"')]),a._v("\nMaximum_epochs "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"40"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#@param [20, 40, 60, 80, 100, 150]")]),a._v("\npython finetune_speaker_v2.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"./OUTPUT_MODEL"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--max_epochs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"{Maximum_epochs}"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--drop_speaker_embed")]),a._v(" True\n")])])]),s("p",[a._v("止步于此，因此后面略....")]),a._v(" "),s("h2",{attrs:{id:"so-vits-svc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#so-vits-svc"}},[a._v("#")]),a._v(" so-vits-svc")]),a._v(" "),s("blockquote",[s("p",[a._v("音乐   》》》 声音")])]),a._v(" "),s("p",[a._v("链接地址："),s("a",{attrs:{href:"https://github.com/svc-develop-team/so-vits-svc",target:"_blank",rel:"noopener noreferrer"}},[a._v("so-vits-svc"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("作者："),s("a",{attrs:{href:"https://github.com/svc-develop-team",target:"_blank",rel:"noopener noreferrer"}},[a._v("svc-develop-team"),s("OutboundLink")],1)]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 预处理")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-b")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4.0")]),a._v(" https://github.com/svc-develop-team/so-vits-svc.git\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ./so-vits-svc\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 必须项")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" http://obs.cstcloud.cn/share/obs/sankagenkeshi/checkpoint_best_legacy_500.pt "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./hubert/checkpoint_best_legacy_500.pt\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 底模（超难）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://huggingface.co/kingple/sovits4/resolve/main/G_0.pth "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./logs/44k/G_0.pth\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://huggingface.co/kingple/sovits4/resolve/main/D_0.pth "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./logs/44k/D_0.pth\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 下载音频")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/Ikaros-521/VITS-fast-fine-tuning/releases/download/v1.0/default.zip "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-O")]),a._v(" ./dataset_raw/custom_character_voice.zip\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("unzip")]),a._v(" ./dataset_raw/custom_character_voice.zip "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" ./dataset_raw/\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 预处理三句话")]),a._v("\npython resample.py\npython preprocess_flist_config.py\npython preprocess_hubert_f0.py\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 可以调节配置config.json的keep_ckpts参数，表示保留n个模型，0为所有，默认3")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 训练")]),a._v("\npython train.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" configs/config.json "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" 44k\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 推理")]),a._v("\npython inference_main.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"logs/44k/G_xx.pth"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"configs/config.json"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"aa.wav"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ikaros"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 可加 -eh True，增强")]),a._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);